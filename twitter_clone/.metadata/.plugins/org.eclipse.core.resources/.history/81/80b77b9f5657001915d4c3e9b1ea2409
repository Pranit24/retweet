package com.me.dao;

import java.util.List;
import java.util.Set;

import org.hibernate.Criteria;
import org.hibernate.HibernateException;
import org.hibernate.criterion.Restrictions;
import org.hibernate.query.Query;

import com.me.pojo.Tweet;
import com.me.pojo.User;

public class TweetDao extends DAO{

	public List<Tweet> getTweet(User user) {
		boolean saved = false;
		try {
			begin();
			Query query = getSession().createQuery("from Tweet where userid="+user.getUserId());
			for(Tweet msg: user.getListOfTweets()) {
				System.out.println(msg.getMessage());
				System.out.println("----");
			}
			commit();
			
		}catch (HibernateException e) {
			rollback();
		}finally {
			close();
		}
		
		return saved;
	}
	
	public void addTweet(User user, Tweet tweet) {
		
		try {
			begin();
			Criteria criteria = getSession().createCriteria(Tweet.class);
			criteria.add(Restrictions.eq("USERID", user.getUserId()));
			Query query = getSession().createQuery("from Tweet where userid="+user.getUserId());
			List<Tweet> tw = query.list();
			tw.add(tweet);
			for(Tweet t: tw) {
				System.out.println(t.getMessage());
			}
			user.setListOfTweets(tw);
			getSession().update(user);
			commit();
			
		}catch (HibernateException e) {
			rollback();
		}finally {
			close();
		}
	}
}
